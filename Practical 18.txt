// Insert sample data
db.city.insertMany([
    { city: "pune", type: "urban", state: "MH", population: "5600000" },
    { city: "mumbai", type: "urban", state: "MH", population: "12000000" },
    { city: "nashik", type: "urban", state: "MH", population: "1500000" },
    { city: "nagpur", type: "urban", state: "MH", population: "2400000" }
]);

// Statewise population
var mapState = function() {
    emit(this.state, parseInt(this.population));
};

var reduceState = function(key, values) {
    return Array.sum(values);
};

db.city.mapReduce(mapState, reduceState, { out: "statewise_population" });
db.statewise_population.find();

// Citywise population
var mapCity = function() {
    emit(this.city, parseInt(this.population));
};

db.city.mapReduce(mapCity, reduceState, { out: "citywise_population" });
db.citywise_population.find();

// Typewise population
var mapType = function() {
    emit(this.type, parseInt(this.population));
};

db.city.mapReduce(mapType, reduceState, { out: "typewise_population" });
db.typewise_population.find();
