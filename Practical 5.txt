DECLARE
    CURSOR c_merge(p_roll NUMBER) IS
        SELECT * FROM N_RollCall WHERE Roll = p_roll;
    
    v_exists NUMBER;
BEGIN
    FOR rec IN (SELECT * FROM N_RollCall) LOOP
        SELECT COUNT(*) INTO v_exists 
        FROM O_RollCall 
        WHERE Roll = rec.Roll;
        
        IF v_exists = 0 THEN
            INSERT INTO O_RollCall VALUES rec;
        END IF;
    END LOOP;
    
    COMMIT;
    DBMS_OUTPUT.PUT_LINE('Merge completed');
    
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('Error: ' || SQLERRM);
END;
/
