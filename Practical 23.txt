import java.sql.*;

public class EmployeeOperations {
    static final String DB_URL = "jdbc:mysql://localhost:3306/testdb";
    static final String USER = "root";
    static final String PASS = "password";
    
    public static void main(String[] args) {
        try {
            Connection conn = DriverManager.getConnection(DB_URL, USER, PASS);
            Statement stmt = conn.createStatement();
            
            // i. Create table
            String createTable = "CREATE TABLE Employee (" +
                "SSN VARCHAR(20) PRIMARY KEY, " +
                "Ename VARCHAR(50), " +
                "state VARCHAR(50), " +
                "salary DECIMAL(10,2))";
            stmt.executeUpdate(createTable);
            System.out.println("Table created");
            
            // ii. Insert records
            String insert = "INSERT INTO Employee VALUES " +
                "('123-45-6789', 'John', 'MH', 50000), " +
                "('234-56-7890', 'Jane', 'Gujarat', 45000)";
            stmt.executeUpdate(insert);
            System.out.println("Records inserted");
            
            // iii. Retrieve by SSN
            String ssn = "123-45-6789";
            PreparedStatement pstmt = conn.prepareStatement(
                "SELECT * FROM Employee WHERE SSN = ?");
            pstmt.setString(1, ssn);
            ResultSet rs = pstmt.executeQuery();
            while(rs.next()) {
                System.out.println("Name: " + rs.getString("Ename"));
            }
            
            // iv. Update state
            stmt.executeUpdate("UPDATE Employee SET state='TN' WHERE state='MH'");
            System.out.println("State updated");
            
            // v. Delete Gujarat employees
            stmt.executeUpdate("DELETE FROM Employee WHERE state='Gujarat'");
            System.out.println("Gujarat employees deleted");
            
            conn.close();
        } catch(Exception e) {
            e.printStackTrace();
        }
    }
}
